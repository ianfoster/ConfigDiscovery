name: siesta
hpc_system: polaris
endpoint_id: 0554c761-5a62-474d-b26e-df7455682bba
environment:
  conda_env: siesta_env
  conda_packages:
    - siesta
installation:
  steps:
    - conda create -n siesta_env -c conda-forge siesta python=3.11 -y
  verification: |
    source /soft/applications/conda/2025-09-25/mconda3/etc/profile.d/conda.sh && \
    conda activate siesta_env && which siesta
execution:
  function: |
    def run_siesta(task="test", output_dir="siesta_output"):
        """Run Siesta DFT calculation."""
        import subprocess
        import os

        output_dir = os.path.abspath(output_dir)
        os.makedirs(output_dir, exist_ok=True)

        conda = "source /soft/applications/conda/2025-09-25/mconda3/etc/profile.d/conda.sh && conda activate siesta_env && "

        # Test mode - verify installation
        cmd = f"{conda}siesta --version"
        result = subprocess.run(cmd, shell=True, capture_output=True, text=True, timeout=60)

        return {
            "status": "completed" if result.returncode == 0 else "failed",
            "version": result.stdout.strip() if result.stdout else result.stderr[:200],
            "output_dir": output_dir
        }
  function_name: run_siesta
  resources:
    nodes: 1
    cores_per_node: 8
    memory_gb: 32
discovery_log:
  discovered_date: '2026-02-12'
  attempts: 1
tags: [dft, materials, periodic, pseudopotentials]
